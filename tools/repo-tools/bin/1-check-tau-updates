#!/bin/sh
export LANG=C
REG_EXP="^\(add\|keep\)[[:blank:]]\+'\([^']\+\)'[^']\+'\([^']\+\)'.*$"
#TODO: interactive check
#TODO: interactive check
TIME_STAMP="$(date "+%Y%m%d-%H%M%S")"
LIST_FILE="conf/tau2lucid.list"
[ ! -r "$LIST_FILE" ] || mv "$LIST_FILE" "$LIST_FILE.$TIME_STAMP"
reprepro dumppull lucid |sed -ne "/$REG_EXP/{s%$REG_EXP%\2	install%;p}" |sort -u > "$LIST_FILE"

cat <<EOF
Filter list: $LIST_FILE updated. Old filter saved as: $LIST_FILE.$TIME_STAMP
Run command:

reprepro -VV --noskipold --export=force  pull lucid

to update 'aurex stable' from 'tau'.
EOF
exit 0

